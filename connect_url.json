const connectURLHost = "int-api.mx.com";
const mxUser = "USR-1f59761c-51a2-4936-8255-a2d7052593e4";
const connectURLString = "https://" + connectURLHost + "/users/" + mxUser + "/widget_urls";
console.log(connectURLString);	
const Buffer = require("buffer").Buffer;
let encodedAuth = new Buffer("6e154f96-6322-4540-a42f-bad957f073c1:3a219b991cfe3faa4673c68e78884c7c7cde18da").toString("base64");
let urlString = undefined;
{/* 	console.log(encodedAuth); */}

if (urlString == undefined) {
		console.log("Generating Connect Widget URL");
		useEffect(() => {
			connectURLRequest();
{/* 			console.log(urlString); */}
		}, []);
	} else {
		console.log("Connect Widget URL valid");
	};
	
	
	const connectURLRequest = async () => {
		  try {
			  console.log('Try connect URL request');
{/* 			  console.log(encodedAuth); */}
			  const response = await fetch(
				  connectURLString, {
				  method: 'POST',
				  headers: {
				  Accept: 'application/vnd.mx.api.v1+json',
				  'Content-Type': 'application/json',
				  'Authorization': 'Basic ' + encodedAuth
					},
					body: JSON.stringify({
					"widget_url": {
						"client_redirect_url": Linking.createURL("/oauth_complete"),
						// "oauth_referral_source": "APP",
						"color_scheme": "light",
						"include_transactions": true,        
						"is_mobile_webview": true,
						"mode": "aggregation",
						// "ui_message_webview_url": "mx",
						"ui_message_version": 4,
						"ui_message_webview_url_scheme": "mx",
						"widget_type": "connect_widget",
					}
					}),
				})
				.catch((error) => {
					console.log('Fetch Error');
					console.error(error);
				});	
			const json = await response.json();
			
{/* 			console.log(json); */}
{/* 			console.log(json.widget_url.url); */}
			urlString = json.widget_url.url;
{/* 			console.log(urlString); */}
{/* 			console.log('test'); */}
		;
		  } catch (error) {
			  console.log("Try Catch Error")
			console.error(error);
		  };
	  };